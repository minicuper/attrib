# http://stackoverflow.com/a/24468752

exports.post = (url, data, cb) ->
  throw new Error 'Only for client-side usage' unless window?
  if typeof data is 'function'
    cb = data
    data = {}

  xhr = new XMLHttpRequest()
  xhr.open 'POST', url, true
  xhr.setRequestHeader 'Content-type', 'application/json'
  xhr.onreadystatechange = ->
    return if xhr.readyState != 4
    return cb(xhr.status)  if xhr.status != 200
    json = JSON.parse(xhr.responseText)
    cb null, json
  data = JSON.stringify(data)
  xhr.send data