index(bem='FormEditor' attributes='items')
  if @meta
    with @meta.items as #items
      with @meta.labels as #labels
        on rerender
          view(is='{{ _layout }}' inherit)
  else
    with @items as #items
      with @labels as #labels
        on rerender
          view(is='{{ _layout }}' inherit)

pure:(bem='InputArray')
  .&
    view(is='controls')

    each valueIds as #itemId, #index
      with value[#itemId] as #item
        view(is='field' on-add='add()' on-remove='remove()' on-duplicate='duplicate()' valueIds='{{valueIds}}' items='{{#items}}' item='{{#item}}' itemId='{{#itemId}}' checked='{{checked}}' on-edit-name='editName()')

    a.&-addPlus.-block(on-click='add()')

columns:(bem='FormEditor')
  view(is='pure' inherit)

controls:(bem='FormEditor')
  with hasChecked(checked) as #hasChecked
    .&-controls
      view(is='clipboard')
      unless allChecked(checked, value.length)
        button.btn(on-click='checkAll()') Select all
      if #hasChecked
        button.btn(on-click='uncheckAll()') De-select all
        button.btn(on-click='export()') Export to file
      button.btn.&-importBtn(on-click='import(importIndex)') Import from file at
      select
        option(selected='{{ importIndex === undefined }}') End
        each indexes as #i
          option(selected='{{ importIndex === #i }}') {{ #i + 1 }}
      if #hasChecked
        button.btn.-error(on-click='removeSelected()') Delete selected items

clipboard:(bem='FormEditor')
  with #hasChecked || clipboard as #activeClipboard
    .&-clipboard(class="{{ #activeClipboard && '-active' }}")
      unless #activeClipboard
        .&-clipboardInfo Select items you want to copy
      if #hasChecked
        button.btn(on-click='copyToClipboard()') Copy selected items
      if clipboard
        button.btn.&-importBtn(on-click='pasteFromClipboard(pasteIndex)') Paste at
        select
          option(selected='{{ pasteIndex === undefined }}') End
          each indexes as #i
            option(selected='{{ pasteIndex === #i }}') {{ #i + 1 }}
        button.btn(on-click='clearClipboard()') Clear clipboard
        .&-clipboardPreview
          each clipboard.valueIds as #itemId
            .&-clipboardPreviewItem {{ #itemId }}
