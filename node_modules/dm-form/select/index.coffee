_ = require 'lodash'

module.exports = class FormSelect extends require('../input')
  view: __dirname
  style: __dirname
  name: 'dm-form:select'

  _getExtraFields: -> [
    'options'
  ]

  init: -> super

  # TODO: Investigate whether it's possible that options array is empty
  optionValue: (option, options = []) ->
    if option?.value?
      option.value
    else
      options.indexOf(option)

  optionName: (option) ->
    if option?.name?
      option.name
    else if option?.title?
      option.title
    else if option?.content
      option.content
    else if option?.value?
      option.value
    else
      option

  # Get name of option by value
  getNameByValue: (value, options = []) ->
    # options must be an array
    if _.isArray(options)
      # If array of objects with names and values
      if options[0]?.value?
        item = _.find(options, {value: value})
        item?.name ? value
      # Indexed-based value
      else
        options[value] ? value

    # if not array for some reason, return value
    else
      value

  ifNull: (value, defaultValue) ->
    value ? defaultValue

